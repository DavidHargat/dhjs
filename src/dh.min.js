var dh={warning:function(t){console.log("[dh.js : WARNING] "+t)},error:function(t){console.error("[dh.js : ERROR] "+t)}};dh.time={delta:0,lastTime:0,currentTime:(new Date).getTime(),passed:0,getTime:function(){return(new Date).getTime()},update:function(){dh.time.lastTime=dh.time.currentTime,dh.time.currentTime=dh.time.getTime();var t=dh.time.currentTime-dh.time.lastTime;dh.time.delta=t,dh.time.passed+=t}},dh.input={keyVal:{backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,left:37,up:38,right:39,down:40,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,zero:48,one:49,two:50,three:51,four:52,five:53,six:54,seven:55,eight:56,nine:57,spacebar:32},addKeydownEvent:function(t,e){document.addEventListener("keydown",function(i){var n=i.keyCode;n==t&&e()})},addKeyupEvent:function(t,e){document.addEventListener("keyup",function(i){var n=i.keyCode;n==t&&e()})}};for(key in dh.input.keyVal)dh.input[key]=!1;document.addEventListener("keydown",function(t){var e=t.keyCode;for(key in dh.input.keyVal)e==dh.input.keyVal[key]&&(dh.input[key]=!0)}),document.addEventListener("keyup",function(t){var e=t.keyCode;for(key in dh.input.keyVal)e==dh.input.keyVal[key]&&(dh.input[key]=!1)}),dh.util={distance:function(t,e,i,n){return 2==arguments.length?dh.util.distanceFromPoints(t,e):4==arguments.length?dh.util.distanceFromValues(t,e,i,n):0},distanceFromValues:function(t,e,i,n){var s;return s=Math.sqrt((i-t)*(i-t)+(n-e)*(n-e))},distanceFromPoints:function(t,e){return t&&e?dh.util.distanceFromValues(t.x,t.y,e.x,e.y):0},direction:function(t,e,i,n){var s=new dh.util.Point(i-t,n-e),h=dh.util.distance(t,e,i,n);return s.div(h),s},Point:function(t,e){this.x=t,this.y=e,this.div=function(t){this.x/=t,this.y/=t},this.mul=function(t){this.x/=t,this.y/=t}},Color:function(t,e,i){this.r=t,this.g=e,this.b=i,this.toString=function(){return"rgb("+this.r+","+this.g+","+this.b+")"}},Container:function(){this.list=[],this.remove=function(t){var e=this.list.indexOf(t);this.list.splice(e,1)},this.add=function(t){this.list.push(t)},this.get=function(t){return this.list[t]},this.clear=function(){this.list=[]},this.size=function(){return this.list.length}}},dh.graphics={canvas:null,context:null,clearColor:"#FFF",setCanvas:function(t){this.canvas=document.getElementById(t),this.context=this.canvas.getContext("2d"),this.canvas.style.margin="auto",this.canvas.style.display="block"},setStyleSize:function(t,e){this.canvas.style.width=t,this.canvas.style.height=e},setSize:function(t,e){this.canvas.width=t,this.canvas.height=e},drawRect:function(t,e,i,n,s,h){h?(this.context.translate(t,e),this.context.rotate(h),this.context.fillStyle=s,this.context.fillRect(0,0,i,n),this.context.rotate(-h),this.context.translate(-t,-e)):(this.context.fillStyle=s,this.context.fillRect(t,e,i,n))},drawRectOutline:function(t,e,i,n,s,h){this.context.strokeStyle=s,this.context.lineWidth=h?h:2,this.context.beginPath(),this.context.rect(t,e,i,n),this.context.stroke(),this.context.closePath()},drawText:function(t,e,i,n,s){this.fontSize=16|s,this.context.fillStyle=n,this.context.beginPath(),this.context.font=this.fontSize+"px Arial",this.context.fillText(t,e,i),this.context.closePath()},drawLine:function(t,e,i,n,s,h){this.context.strokeStyle=s,this.context.lineWidth=h,this.context.beginPath(),this.context.moveTo(t,e),this.context.lineTo(i,n),this.context.stroke(),this.context.closePath()},drawCircle:function(t,e,i,n){this.context.fillStyle=n,this.context.beginPath(),this.context.arc(t,e,i,0,2*Math.PI),this.context.fill(),this.context.closePath()},drawCircleOutline:function(t,e,i,n,w){this.context.lineWidth=w,this.context.strokeStyle=n,this.context.beginPath(),this.context.arc(t,e,i,0,2*Math.PI),this.context.stroke(),this.context.closePath()},drawImage:function(t,e,i,n,s,h){if(!t)return void dh.error("attempted to draw undefined.");if(dh.resources.loading&&dh.warning("drawing while resource are loading."),h){var o=Math.round(10*h)/10;this.context.translate(e+n/2,i+s/2),this.context.rotate(o/(360*Math.PI/180)),this.context.drawImage(t,-n/2,-s/2,n,s),this.context.rotate(-o/(360*Math.PI/180)),this.context.translate(-e-n/2,-i-s/2)}else this.context.drawImage(t,e,i,n,s)},clear:function(t){this.drawRect(0,0,this.canvas.width,this.canvas.height,t)}},dh.resources={sourceList:[],loading:!1,getImage:function(t){return void 0==this.imageMap[t]?this.imageMap["dh/loading.png"]:this.imageMap[t]},imageMap:{},load:function(t){var e=t.split(".")[1];("png"==e||"gif"==e||"jpg"==e)&&this.loadImage(t)},clear:function(){this.sourceList=[],this.imageMap={}},loadImage:function(t){this.sourceList.indexOf(t)>-1&&this.sourceList.splice(this.sourceList.indexOf(t),1),this.sourceList.push(t);var e=this.sourceList.length-1;this.loading=!0;var i=new Image;i.onload=function(){dh.resources.loading=!1,dh.resources.imageMap[t]=i},i.onerror=function(){dh.error("Could not load img '"+t+"'"),dh.resources.loading=!1,dh.resources.sourceList.splice(e,1)},i.src=t},isLoaded:function(){for(var t=!0,e=0;e<this.sourceList.length;e++){var i=this.sourceList[e];"dh/loading.png"!=i&&(this.getImage(i)?"dh/loading.png"==this.getImage(i).src&&(t=!1):t=!1)}return t},drawLoadingScreen:function(){var t=dh.graphics,e=dh.graphics.canvas.width,i=dh.graphics.canvas.height;t.drawRect(0,0,e,i,"#000"),t.drawCircle(e/2,0,e/1.5,"#fa0"),t.drawCircle(e/2,0,e/1.5-e/16,"#000"),t.drawCircle(e/2,0,e/1.5-e/8,"#fa0"),t.fontSize=e/10,t.drawText("dh.js",e/4+e/10,i/8,"#000"),t.drawText("loading...",e/4+e/32,i/4+e/10,"#fff")},onLoad:function(t){this.isLoaded()?(dh.graphics.clear("#000"),t()):(this.drawLoadingScreen(),setTimeout(function(){dh.resources.onLoad(t)},1))}},dh.resources.load("dh/loading.png"),dh.mouse={x:0,y:0,addDownEvent:function(t){dh.graphics.canvas.addEventListener("mousedown",t,!1)},addUpEvent:function(t){dh.graphics.canvas.addEventListener("mouseup",t,!1)},pressed:!1,listen:function(){this.addDownEvent(function(){dh.mouse.pressed=!0}),this.addUpEvent(function(){dh.mouse.pressed=!1}),dh.graphics.canvas.onmousemove=function(t){dh.mouse.x=t.pageX-dh.graphics.canvas.getBoundingClientRect().left,dh.mouse.y=t.pageY-dh.graphics.canvas.getBoundingClientRect().top}}},dh.block={create:function(t,e,i,n){return new function(){this.x=t,this.y=e,this.width=i,this.height=n,this.left=function(){return this.x},this.right=function(){return this.x+this.width},this.top=function(){return this.y},this.bottom=function(){return this.y+this.height},this.touches=function(t){return dh.block.touch(this,t)},this.distance=function(t){return dh.block.distance(this,t)},this.move=function(t,e){this.x+=t,this.y+=e}}},touch:function(t,e){return t.right()<e.left()?!1:t.left()>e.right()?!1:t.bottom()<e.top()?!1:t.top()>e.bottom()?!1:!0},distance:function(t,e){return dh.util.distance(t.x+t.width/2,t.y+t.height/2,e.x+e.width/2,e.y+e.height/2)},splitY:function(t,e){if(1==arguments.length){var i=dh.block.create(t.x,t.y,t.width/2,t.height),n=dh.block.create(t.x+t.width/2,t.y,t.width/2,t.height);return[i,n]}var i=dh.block.create(t.x,t.y,e,t.height),n=dh.block.create(t.x+e,t.y,t.width-e,t.height);return[i,n]},splitX:function(t,e){if(1==arguments.length){var i=dh.block.create(t.x,t.y,t.width,t.height/2),n=dh.block.create(t.x,t.y+t.height/2,t.width,t.height/2);return[i,n]}var i=dh.block.create(t.x,t.y,t.width,e),n=dh.block.create(t.x,t.y+e,t.width,t.height-e);return[i,n]}};